<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>网站后台 | xyt556</title>
  <link href="/admin/config.yml" rel="cms-config-url">
  <style>
    #admin-fallback { display: none; padding: 2rem; text-align: center; font-family: sans-serif; max-width: 28em; margin: 2rem auto; line-height: 1.6; }
    #admin-fallback.show { display: block; }
    #admin-fallback a { color: #22c55e; }
  </style>
</head>
<body>
  <noscript>请启用 JavaScript 以使用后台编辑。</noscript>
  <div id="admin-github-pages-hint" style="display:none; padding:1rem 1.5rem; margin:0 0 1rem; background:#1e3a5f; color:#e2e8f0; font-family:sans-serif; font-size:0.9rem; line-height:1.5;">
    <strong>提示：</strong>当前是 GitHub Pages 地址，此处点击「Login with GitHub」会显示 Not Found。<br>
    请改用 <strong>Netlify 后台地址</strong> 登录：在 Netlify 部署本仓库后，使用 <code style="background:#0f172a;padding:0.2em 0.4em;">https://你的站点名.netlify.app/admin/</code> 打开后台再点登录。详见 README。
  </div>
  <div id="cms-loading" style="padding:2rem;text-align:center;font-family:sans-serif;">正在加载后台…</div>
  <div id="admin-fallback">
    <p><strong>后台未能加载</strong></p>
    <p>请尝试：</p>
    <ul style="text-align:left;">
      <li>使用 VPN 或更换网络后 <a href="/admin/">刷新页面</a></li>
      <li>按 F12 打开开发者工具，在「Console」里查看是否有红色报错，便于排查</li>
    </ul>
    <p><a href="/admin/">点击此处重试</a></p>
  </div>
  <script src="/static/js/decap-cms.js" id="cms-script"></script>
  <script>
    (function () {
      var loading = document.getElementById('cms-loading');
      var fallback = document.getElementById('admin-fallback');
      var scriptEl = document.getElementById('cms-script');

      function showFallback() {
        if (loading) loading.style.display = 'none';
        if (fallback) fallback.classList.add('show');
      }

      if (window.location.hostname.indexOf('github.io') !== -1) {
        document.getElementById('admin-github-pages-hint').style.display = 'block';
      }
      scriptEl.addEventListener('error', function () {
        showFallback();
        if (fallback) fallback.insertAdjacentHTML('afterbegin', '<p>脚本加载失败，请检查网络。</p>');
      });

      setTimeout(function () {
        var hasCms = document.getElementById('nc-root') || document.querySelector('[class^="nc-"]') || document.querySelector('.netlify-login');
        if (!hasCms && loading && loading.offsetParent !== null) {
          showFallback();
        }
      }, 12000);
    })();
  </script>
</body>
</html>
